/*********************************************************************************/
/********** THIS FILE IS GENERATED BY TOUCHGFX DESIGNER, DO NOT MODIFY ***********/
/*********************************************************************************/
#include <gui_generated/screensaver_screen/ScreenSaverViewBase.hpp>
#include "BitmapDatabase.hpp"

ScreenSaverViewBase::ScreenSaverViewBase() :
    waitToEndScreenCounter(0),
    buttonCallback(this, &ScreenSaverViewBase::buttonCallbackHandler)
{

    background.setXY(0, 0);
    background.setBitmap(touchgfx::Bitmap(BITMAP_SCREENSAVER_BACKGROUND_ID));

    quitButton.setXY(415, 216);
    quitButton.setBitmaps(touchgfx::Bitmap(BITMAP_GOTOMENU_ID), touchgfx::Bitmap(BITMAP_GOTOMENU_ID));
    quitButton.setAction(buttonCallback);

    logo.setXY(59, 90);
    logo.setBitmap(touchgfx::Bitmap(BITMAP_TGFX_SHADOW_LOGO_ID));

    add(background);
    add(quitButton);
    add(logo);
}

void ScreenSaverViewBase::setupScreen()
{

}

//Handles delays
void ScreenSaverViewBase::handleTickEvent()
{
    if(waitToEndScreenCounter > 0)
    {
        waitToEndScreenCounter--;
        if(waitToEndScreenCounter == 0)
        {
            //endScreenSaver
            //When waitToEndScreen completed change screen to Main
            //Go to Main with no screen transition
            application().gotoMainScreenNoTransition();
        }
    }
}

//Called when the screen is done with transition/load
void ScreenSaverViewBase::afterTransition()
{
    //Interaction1
    //When screen is entered execute C++ code
    //Execute C++ code
    waitToEndScreenCounter = 0;
}

void ScreenSaverViewBase::buttonCallbackHandler(const touchgfx::AbstractButton& src)
{
    if (&src == &quitButton)
    {
        //quitScreenSaverInitiated
        //When quitButton clicked call virtual function
        //Call endScreenSaverAnimation
        endScreenSaverAnimation();

        //waitToEndScreen
        //When quitScreenSaverInitiated completed delay
        //Delay for 1200 ms (72 Ticks)
        waitToEndScreenCounter = WAITTOENDSCREEN_DURATION;

        //fadeLogo
        //When quitScreenSaverInitiated completed fade logo
        //Fade logo to alpha:0 with CubicIn easing in 605 ms (36 Ticks)
        logo.clearFadeAnimationEndedAction();
        logo.startFadeAnimation(0, 36, touchgfx::EasingEquations::cubicEaseIn);
    }
}
